{% extends "base.html" %}

{% block title %}My Account | AutoShop{% endblock %}

{% block content %}
<div class="container" style="padding: 48px 0;">
    <div class="account-layout" style="display: grid; grid-template-columns: 250px 1fr; gap: 32px;">
        <!-- Sidebar -->
        <aside class="account-sidebar">
            <nav class="account-nav">
                <a href="{{ url_for('account') }}" class="account-nav__link account-nav__link--active">Dashboard</a>
                <a href="{{ url_for('account_orders') }}" class="account-nav__link">My Orders</a>
                <a href="{{ url_for('account_profile') }}" class="account-nav__link">Profile Settings</a>
                <a href="{{ url_for('account_password') }}" class="account-nav__link">Change Password</a>
                <a href="{{ url_for('logout') }}" class="account-nav__link">Logout</a>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="account-content">
            <div class="welcome-section" style="margin-bottom: 32px;">
                <h1 style="font-size: 28px; margin-bottom: 8px;">Welcome back, {{ user.username }}!</h1>
                <p style="color: var(--grey-text, #666);">Manage your account and view your orders</p>
            </div>

            <!-- Stats Cards -->
            <div class="stats-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 32px;">
                <a href="{{ url_for('account_orders') }}" class="stat-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 24px; border-radius: 12px; text-decoration: none; transition: transform 0.2s, box-shadow 0.2s; cursor: pointer; position: relative; overflow: hidden;">
                    <div style="position: relative; z-index: 2;">
                        <div style="font-size: 14px; opacity: 0.8; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.5px;">Total Orders</div>
                        <div style="font-size: 48px; font-weight: 800; line-height: 1;">{{ stats.total_orders if stats else 0 }}</div>
                        <div style="margin-top: 8px; font-size: 13px; opacity: 0.9;">
                            <i class="fa-solid fa-shopping-bag"></i> All your orders
                        </div>
                    </div>
                    <div style="position: absolute; top: -20px; right: -20px; font-size: 120px; opacity: 0.1; z-index: 1;">
                        <i class="fa-solid fa-shopping-bag"></i>
                    </div>
                </a>
                <a href="{{ url_for('account_orders') }}?status_filter=pending" class="stat-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; padding: 24px; border-radius: 12px; text-decoration: none; transition: transform 0.2s, box-shadow 0.2s; cursor: pointer; position: relative; overflow: hidden;">
                    <div style="position: relative; z-index: 2;">
                        <div style="font-size: 14px; opacity: 0.8; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.5px;">Pending</div>
                        <div style="font-size: 48px; font-weight: 800; line-height: 1;">{{ stats.pending_orders if stats else 0 }}</div>
                        <div style="margin-top: 8px; font-size: 13px; opacity: 0.9;">
                            <i class="fa-solid fa-clock"></i> Awaiting processing
                        </div>
                    </div>
                    <div style="position: absolute; top: -20px; right: -20px; font-size: 120px; opacity: 0.1; z-index: 1;">
                        <i class="fa-solid fa-clock"></i>
                    </div>
                </a>
                <a href="{{ url_for('account_orders') }}?status_filter=delivered" class="stat-card" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; padding: 24px; border-radius: 12px; text-decoration: none; transition: transform 0.2s, box-shadow 0.2s; cursor: pointer; position: relative; overflow: hidden;">
                    <div style="position: relative; z-index: 2;">
                        <div style="font-size: 14px; opacity: 0.8; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.5px;">Completed</div>
                        <div style="font-size: 48px; font-weight: 800; line-height: 1;">{{ stats.completed_orders if stats else 0 }}</div>
                        <div style="margin-top: 8px; font-size: 13px; opacity: 0.9;">
                            <i class="fa-solid fa-check-circle"></i> Successfully delivered
                        </div>
                    </div>
                    <div style="position: absolute; top: -20px; right: -20px; font-size: 120px; opacity: 0.1; z-index: 1;">
                        <i class="fa-solid fa-check-circle"></i>
                    </div>
                </a>
                <a href="{{ url_for('account_orders') }}" class="stat-card" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); color: white; padding: 24px; border-radius: 12px; text-decoration: none; transition: transform 0.2s, box-shadow 0.2s; cursor: pointer; position: relative; overflow: hidden;">
                    <div style="position: relative; z-index: 2;">
                        <div style="font-size: 14px; opacity: 0.8; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.5px;">Total Spent</div>
                        <div style="font-size: 48px; font-weight: 800; line-height: 1;">${{ "%.2f"|format(stats.total_spent) if stats and stats.total_spent else "0.00" }}</div>
                        <div style="margin-top: 8px; font-size: 13px; opacity: 0.9;">
                            <i class="fa-solid fa-wallet"></i> Lifetime spending
                        </div>
                    </div>
                    <div style="position: absolute; top: -20px; right: -20px; font-size: 120px; opacity: 0.1; z-index: 1;">
                        <i class="fa-solid fa-wallet"></i>
                    </div>
                </a>
            </div>

            <!-- Recent Orders -->
            <section>
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                    <h2 style="font-size: 20px;">Recent Orders</h2>
                    <a href="{{ url_for('account_orders') }}" style="color: var(--primary-color, #667eea); text-decoration: none;">View All â†’</a>
                </div>

                {% if recent_orders %}
                <div class="recent-orders-list">
                    {% for order in recent_orders %}
                    <div class="order-card" style="background: var(--background-default, #f5f5f5); padding: 20px; border-radius: 8px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <h3 style="font-size: 16px; margin-bottom: 4px;">Order #{{ order.id }}</h3>
                            <p style="color: var(--grey-text, #666); font-size: 14px;">{{ order.created_at.strftime('%B %d, %Y') if order.created_at else '' }}</p>
                        </div>
                        <div style="text-align: right;">
                            <div style="margin-bottom: 4px;">
                                <span class="order-status status-{{ order.status.value }}" style="padding: 4px 12px; border-radius: 12px; font-size: 12px; font-weight: 500;">
                                    {{ order.status.value|title }}
                                </span>
                            </div>
                            <div style="font-weight: 600; font-size: 18px;">${{ "%.2f"|format(order.total_price) }}</div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <div class="no-orders" style="text-align: center; padding: 48px; background: var(--background-default, #f5f5f5); border-radius: 8px;">
                    <i class="fa-solid fa-box-open" style="font-size: 48px; color: var(--grey-text, #666); margin-bottom: 16px;"></i>
                    <p style="font-size: 16px; color: var(--grey-text, #666); margin-bottom: 16px;">No orders yet</p>
                    <a href="{{ url_for('catalog') }}" class="button button--primary">Start Shopping</a>
                </div>
                {% endif %}
            </section>
        </main>
    </div>
</div>

<style>
    .account-nav {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }
    .account-nav__link {
        padding: 12px 16px;
        text-decoration: none;
        color: var(--text-primary, #333);
        border-radius: 8px;
        transition: background 0.2s;
    }
    .account-nav__link:hover {
        background: var(--background-default, #f5f5f5);
    }
    .account-nav__link--active {
        background: var(--primary-color, #667eea);
        color: white;
    }
    .stat-card {
        display: block;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .stat-card:hover {
        transform: translateY(-8px) scale(1.02);
        box-shadow: 0 12px 32px rgba(0,0,0,0.3);
    }
    .stat-card:active {
        transform: translateY(-4px) scale(1.01);
    }
    .status-pending { background: #fef3c7; color: #92400e; }
    .status-processing { background: #dbeafe; color: #1e40af; }
    .status-shipped { background: #e0e7ff; color: #3730a3; }
    .status-delivered { background: #d1fae5; color: #065f46; }
    .status-cancelled { background: #fee2e2; color: #991b1b; }
    @media (max-width: 768px) {
        .account-layout {
            grid-template-columns: 1fr;
        }
        .account-sidebar {
            order: 2;
        }
        .account-nav {
            flex-direction: row;
            overflow-x: auto;
        }
    }
</style>
{% endblock %}
